{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/frkul/Documents/smurf.money/blzd-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/frkul/Documents/smurf.money/blzd-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/frkul/Documents/smurf.money/blzd-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import BigNumber from'bignumber.js';import{useWallet}from'@binance-chain/bsc-use-wallet';import{useCake,useLottery,useXBlzd}from'./useContract';import{getAllowance}from'../utils/erc20';// Retrieve lottery allowance\nexport var useLotteryAllowance=function useLotteryAllowance(){var _useState=useState(new BigNumber(0)),_useState2=_slicedToArray(_useState,2),allowance=_useState2[0],setAllowance=_useState2[1];var _useWallet=useWallet(),account=_useWallet.account;var lotteryContract=useLottery();var cakeContract=useCake();useEffect(function(){var fetchAllowance=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getAllowance(cakeContract,lotteryContract,account);case 2:res=_context.sent;setAllowance(new BigNumber(res));case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetchAllowance(){return _ref.apply(this,arguments);};}();if(account&&cakeContract&&cakeContract){fetchAllowance();}var refreshInterval=setInterval(fetchAllowance,10000);return function(){return clearInterval(refreshInterval);};},[account,cakeContract,lotteryContract]);return allowance;};// Retrieve IFO allowance\nexport var useIfoAllowance=function useIfoAllowance(tokenContract,spenderAddress,dependency){var _useWallet2=useWallet(),account=_useWallet2.account;var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),allowance=_useState4[0],setAllowance=_useState4[1];useEffect(function(){var fetch=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return tokenContract.methods.allowance(account,spenderAddress).call();case 3:res=_context2.sent;setAllowance(new BigNumber(res));_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);setAllowance(null);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function fetch(){return _ref2.apply(this,arguments);};}();fetch();},[account,spenderAddress,tokenContract,dependency]);return allowance;};// Retrieve xBlzd allowance\nexport var useXBlzdAllowance=function useXBlzdAllowance(){var _useState5=useState(new BigNumber(0)),_useState6=_slicedToArray(_useState5,2),allowance=_useState6[0],setAllowance=_useState6[1];var _useWallet3=useWallet(),account=_useWallet3.account;var xBlzdContract=useXBlzd();var cakeContract=useCake();useEffect(function(){var fetchAllowance=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return getAllowance(cakeContract,xBlzdContract,account);case 2:res=_context3.sent;setAllowance(new BigNumber(res));case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function fetchAllowance(){return _ref3.apply(this,arguments);};}();if(account&&cakeContract){fetchAllowance();}var refreshInterval=setInterval(fetchAllowance,10000);return function(){return clearInterval(refreshInterval);};},[account,xBlzdContract,cakeContract]);return allowance;};","map":{"version":3,"sources":["C:/Users/frkul/Documents/smurf.money/blzd-frontend/src/hooks/useAllowance.ts"],"names":["useEffect","useState","BigNumber","useWallet","useCake","useLottery","useXBlzd","getAllowance","useLotteryAllowance","allowance","setAllowance","account","lotteryContract","cakeContract","fetchAllowance","res","refreshInterval","setInterval","clearInterval","useIfoAllowance","tokenContract","spenderAddress","dependency","fetch","methods","call","useXBlzdAllowance","xBlzdContract"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react'\r\nimport BigNumber from 'bignumber.js'\r\nimport { useWallet } from '@binance-chain/bsc-use-wallet'\r\nimport { Contract } from 'web3-eth-contract'\r\nimport { useCake, useLottery, useXBlzd } from './useContract'\r\nimport { getAllowance } from '../utils/erc20'\r\n\r\n// Retrieve lottery allowance\r\nexport const useLotteryAllowance = () => {\r\n  const [allowance, setAllowance] = useState(new BigNumber(0))\r\n  const { account }: { account: string } = useWallet()\r\n  const lotteryContract = useLottery()\r\n  const cakeContract = useCake()\r\n\r\n  useEffect(() => {\r\n    const fetchAllowance = async () => {\r\n      const res = await getAllowance(cakeContract, lotteryContract, account)\r\n      setAllowance(new BigNumber(res))\r\n    }\r\n\r\n    if (account && cakeContract && cakeContract) {\r\n      fetchAllowance()\r\n    }\r\n    const refreshInterval = setInterval(fetchAllowance, 10000)\r\n    return () => clearInterval(refreshInterval)\r\n  }, [account, cakeContract, lotteryContract])\r\n\r\n  return allowance\r\n}\r\n\r\n// Retrieve IFO allowance\r\nexport const useIfoAllowance = (tokenContract: Contract, spenderAddress: string, dependency?: any) => {\r\n  const { account }: { account: string } = useWallet()\r\n  const [allowance, setAllowance] = useState(null)\r\n\r\n  useEffect(() => {\r\n    const fetch = async () => {\r\n      try {\r\n        const res = await tokenContract.methods.allowance(account, spenderAddress).call()\r\n        setAllowance(new BigNumber(res))\r\n      } catch (e) {\r\n        setAllowance(null)\r\n      }\r\n    }\r\n    fetch()\r\n  }, [account, spenderAddress, tokenContract, dependency])\r\n\r\n  return allowance\r\n}\r\n\r\n// Retrieve xBlzd allowance\r\nexport const useXBlzdAllowance = () => {\r\n  const [allowance, setAllowance] = useState(new BigNumber(0))\r\n  const { account }: { account: string } = useWallet()\r\n  const xBlzdContract = useXBlzd()\r\n  const cakeContract = useCake()\r\n\r\n  useEffect(() => {\r\n    const fetchAllowance = async () => {\r\n      const res = await getAllowance(cakeContract, xBlzdContract, account)\r\n      setAllowance(new BigNumber(res))\r\n    }\r\n\r\n    if (account && cakeContract) {\r\n      fetchAllowance()\r\n    }\r\n    const refreshInterval = setInterval(fetchAllowance, 10000)\r\n    return () => clearInterval(refreshInterval)\r\n  }, [account, xBlzdContract, cakeContract])\r\n\r\n  return allowance\r\n}\r\n"]},"metadata":{},"sourceType":"module"}